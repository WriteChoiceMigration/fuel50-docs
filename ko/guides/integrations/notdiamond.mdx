---
- title: Not Diamond ¬◇
- description: Not Diamond를 사용하여 프롬프트를 필요에 맞는 적절한 모델로 라우팅하면서 정확도를 최대화하고 비용을 절약하세요
---

복잡한 LLM 워크플로우를 구축할 때 사용자는 정확도, 비용 또는 호출 지연 시간에 따라 다른 모델을 프롬프트해야 할 수 있습니다. 사용자는 다음을 사용할 수 있습니다[Not Diamond][nd] 이러한 워크플로우에서 프롬프트를 필요에 맞는 적절한 모델로 라우팅하여 정확도를 최대화하면서 모델 비용을 절약하는 데 도움을 줍니다.

## 시작하기

다음 사항을 확인하세요 [계정 생성][account] 및 [API 키 생성][keys], 그런 다음 API 키를 환경 변수에 추가하세요 `NOTDIAMOND_API_KEY`.

!\[[API 키 생성](imgs/notdiamond/api-keys.png)]

여기서부터 다음을 할 수 있습니다

* 다음을 시도해 보세요 [빠른 시작 가이드][quickstart guide],
* [커스텀 라우터 구축][custom router] W\&B Weave와 Not Diamond를 사용하거나,
* [Not Diamond와 채팅][chat] 하여 라우팅이 작동하는 것을 확인하세요

## 추적

Weave는 다음과 통합됩니다 [Not Diamond의 Python 라이브러리][python] 를 통해 [API 호출을 자동으로 기록][ops]합니다.
워크플로우 시작 시 다음만 실행하면 됩니다 `weave.init()` 그런 다음 평소와 같이 라우팅된 제공자를 계속 사용하세요:

```python
from notdiamond import NotDiamond

import weave
weave.init('notdiamond-quickstart')

client = NotDiamond()
session_id, provider = client.chat.completions.model_select(
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Concisely explain merge sort."}
    ],
    model=['openai/gpt-4o', 'anthropic/claude-3-5-sonnet-20240620']
)

print("LLM called: ", provider.provider)  # openai, anthropic, etc
print("Provider model: ", provider.model) # gpt-4o, claude-3-5-sonnet-20240620, etc
```

## 커스텀 라우팅

또한 다음을 통해 자체 [커스텀 라우터][custom router]를 [평가][evals]에서 훈련할 수 있으며, 이를 통해 Not Diamond가 특수한 사용 사례에 대한 평가 성능에 따라 프롬프트를 라우팅할 수 있습니다.

커스텀 라우터 훈련부터 시작하세요:

```python
from weave.flow.eval import EvaluationResults
from weave.integrations.notdiamond.custom_router import train_router

# Build an Evaluation on gpt-4o and Claude 3.5 Sonnet
evaluation = weave.Evaluation(...)
gpt_4o = weave.Model(...)
sonnet = weave.Model(...)

model_evals = {
    'openai/gpt-4o': evaluation.get_eval_results(gpt_4o),
    'anthropic/claude-3-5-sonnet-20240620': evaluation.get_eval_results(sonnet),
}
preference_id = train_router(
    model_evals=model_evals,
    prompt_column="prompt",
    response_column="actual",
    language="en",
    maximize=True,
)
```

이 선호도 ID를 모든 `model_select` 요청에서 재사용하여 평가 데이터에서 성능을 최대화하고 비용을 최소화하도록 프롬프트를 라우팅할 수 있습니다:

```python
from notdiamond import NotDiamond
client = NotDiamond()

import weave
weave.init('notdiamond-quickstart')

session_id, provider = client.chat.completions.model_select(
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Concisely explain merge sort."}
    ],
    model=['openai/gpt-4o', 'anthropic/claude-3-5-sonnet-20240620'],

    # passing this preference ID reuses your custom router
    preference_id=preference_id
)

print("LLM called: ", provider.provider)  # openai, anthropic, etc
print("Provider model: ", provider.model) # gpt-4o, claude-3-5-sonnet-20240620, etc
```

## 추가 지원

다음을 방문하세요 [문서][docs] 또는 [메시지 보내기][support] 추가 지원을 받으세요.

[account]: https://app.notdiamond.ai

[chat]: https://chat.notdiamond.ai

[custom router]: https://docs.notdiamond.ai/docs/router-training-quickstart

[docs]: https://docs.notdiamond.ai

[evals]: ../../guides/core-types/evaluations.md

[keys]: https://app.notdiamond.ai/keys

[nd]: https://www.notdiamond.ai/

[ops]: ../../guides/tracking/ops.md

[python]: https://github.com/Not-Diamond/notdiamond-python

[quickstart guide]: https://docs.notdiamond.ai/docs/quickstart

[support]: mailto:support@notdiamond.ai
